--- ./Format/Format.rc	2012-02-07 14:36:48.000000000 +0400
+++ ../veracrypt_1.17_Source/src/Format/Format.rc	2016-02-14 12:11:21.000000000 +0300
@@ -28,8 +28,8 @@
 //
 
 VS_VERSION_INFO VERSIONINFO
- FILEVERSION 7,1,1,0
- PRODUCTVERSION 7,1,1,0
+ FILEVERSION 1,17,22,0
+ PRODUCTVERSION 1,17,22,0
  FILEFLAGSMASK 0x17L
 #ifdef _DEBUG
  FILEFLAGS 0x1L
@@ -44,13 +44,13 @@
     BEGIN
         BLOCK "040904b0"
         BEGIN
-            VALUE "CompanyName", "TrueCrypt Foundation"
-            VALUE "FileDescription", "TrueCrypt Format"
-            VALUE "FileVersion", "7.1a"
-            VALUE "LegalTrademarks", "TrueCrypt"
-            VALUE "OriginalFilename", "TrueCrypt Format.exe"
-            VALUE "ProductName", "TrueCrypt"
-            VALUE "ProductVersion", "7.1a"
+            VALUE "CompanyName", "IDRIX"
+            VALUE "FileDescription", "VeraCrypt Format"
+            VALUE "FileVersion", "1.17"
+            VALUE "LegalTrademarks", "VeraCrypt"
+            VALUE "OriginalFilename", "VeraCrypt Format.exe"
+            VALUE "ProductName", "VeraCrypt"
+            VALUE "ProductVersion", "1.17"
         END
     END
     BLOCK "VarFileInfo"
@@ -79,23 +79,23 @@
 // Dialog
 //
 
-IDD_VOL_CREATION_WIZARD_DLG DIALOGEX 0, 0, 400, 209
+IDD_VOL_CREATION_WIZARD_DLG DIALOGEX 0, 0, 400, 229
 STYLE DS_SETFONT | DS_SETFOREGROUND | DS_FIXEDSYS | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU
-CAPTION "TrueCrypt Volume Creation Wizard"
-CLASS "CustomDlg"
+CAPTION "VeraCrypt Volume Creation Wizard"
+CLASS "VeraCryptCustomDlg"
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
-    PUSHBUTTON      "&Help",IDHELP,176,189,50,14
-    PUSHBUTTON      "",IDC_PREV,235,189,50,14
-    DEFPUSHBUTTON   "",IDC_NEXT,285,189,50,14
-    PUSHBUTTON      "Cancel",IDCANCEL,343,189,50,14
+    PUSHBUTTON      "&Help",IDHELP,176,209,50,14
+    PUSHBUTTON      "",IDC_PREV,235,209,50,14
+    DEFPUSHBUTTON   "",IDC_NEXT,285,209,50,14
+    PUSHBUTTON      "Cancel",IDCANCEL,343,209,50,14
     LTEXT           "",IDC_BOX_TITLE,160,8,233,17
-    GROUPBOX        "",IDC_STATIC,4,0,392,183
+    GROUPBOX        "",IDC_STATIC,4,0,392,203
     CONTROL         116,IDC_BITMAP_WIZARD,"Static",SS_BITMAP | SS_SUNKEN,10,9,137,169
-    LTEXT           "",IDC_POS_BOX,160,24,231,152
+    LTEXT           "",IDC_POS_BOX,160,24,231,172
 END
 
-IDD_CIPHER_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_CIPHER_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -110,43 +110,45 @@
     LTEXT           "Information on hash algorithms",IDC_LINK_HASH_INFO,97,124,115,8,SS_NOTIFY
 END
 
-IDD_PASSWORD_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_PASSWORD_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
     EDITTEXT        IDC_PASSWORD,53,3,163,14,ES_PASSWORD | ES_AUTOHSCROLL
     EDITTEXT        IDC_VERIFY,53,19,163,14,ES_PASSWORD | ES_AUTOHSCROLL
-    CONTROL         "&Display password",IDC_SHOW_PASSWORD,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,53,45,95,11,WS_EX_TRANSPARENT
     CONTROL         "U&se keyfiles",IDC_KEYFILES_ENABLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,53,35,95,10
     PUSHBUTTON      "&Keyfiles...",IDC_KEY_FILES,152,36,64,14,WS_DISABLED
+    CONTROL         "&Display password",IDC_SHOW_PASSWORD,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,53,45,95,11,WS_EX_TRANSPARENT
+    CONTROL         "Use P&IM",IDC_PIM_ENABLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,53,56,97,10
     RTEXT           "Password:",IDT_PASSWORD,1,6,50,8
     RTEXT           "&Confirm:",IDT_CONFIRM,1,23,50,8
-    LTEXT           "",IDC_BOX_HELP,0,59,225,89
+    LTEXT           "",IDC_BOX_HELP,0,71,225,97
 END
 
-IDD_SIZE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SIZE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
     EDITTEXT        IDC_SIZEBOX,0,22,71,14,ES_AUTOHSCROLL | ES_NUMBER
-    CONTROL         "&KB",IDC_KB,"Button",BS_AUTORADIOBUTTON | WS_GROUP | WS_TABSTOP,80,25,38,10
-    CONTROL         "&MB",IDC_MB,"Button",BS_AUTORADIOBUTTON,119,25,38,10
-    CONTROL         "&GB",IDC_GB,"Button",BS_AUTORADIOBUTTON,158,25,38,10
+    CONTROL         "&KB",IDC_KB,"Button",BS_AUTORADIOBUTTON | WS_GROUP | WS_TABSTOP,80,25,27,10
+    CONTROL         "&MB",IDC_MB,"Button",BS_AUTORADIOBUTTON,115,25,27,10
+    CONTROL         "&GB",IDC_GB,"Button",BS_AUTORADIOBUTTON,150,25,27,10
     LTEXT           "",IDC_BOX_HELP,0,75,214,64
     LTEXT           "",IDC_SPACE_LEFT,0,44,214,21
+    CONTROL         "&TB",IDC_TB,"Button",BS_AUTORADIOBUTTON,185,25,27,10
 END
 
-IDD_VOLUME_LOCATION_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_VOLUME_LOCATION_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
     COMBOBOX        IDC_COMBO_BOX,0,9,148,80,CBS_DROPDOWN | CBS_AUTOHSCROLL | WS_VSCROLL | WS_TABSTOP
     CONTROL         "&Never save history",IDC_NO_HISTORY,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,3,28,137,10
     PUSHBUTTON      "",IDC_SELECT_VOLUME_LOCATION,155,9,62,14
-    LTEXT           "",IDC_BOX_HELP,0,45,219,104
+    LTEXT           "",IDC_BOX_HELP,0,45,219,108
 END
 
-IDD_FORMAT_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_FORMAT_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -174,9 +176,11 @@
     RTEXT           "Random Pool: ",IDT_RANDOM_POOL,2,39,54,8
     GROUPBOX        "",IDC_STATIC,0,32,225,35
     CONTROL         "",IDC_RANDOM_BYTES,"Static",SS_SIMPLE | WS_GROUP,57,38,155,8,WS_EX_TRANSPARENT
+    GROUPBOX        "Randomness Collected From Mouse Movements",IDT_ENTROPY_BAR,0,153,224,18
+    CONTROL         "",IDC_ENTROPY_BAR,"msctls_progress32",WS_BORDER,11,162,202,6
 END
 
-IDD_INTRO_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_INTRO_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -193,22 +197,22 @@
     LTEXT           "Encrypts the partition/drive where Windows is installed. Anyone who wants to gain access and use the system, read and write files, etc., will need to enter the correct password each time before Windows boots. Optionally, creates a hidden system.",IDT_SYS_DEVICE,16,100,205,33
 END
 
-IDD_INFO_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_INFO_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
     LTEXT           "",IDC_BOX_HELP,0,10,225,137
 END
 
-IDD_HIDVOL_HOST_FILL_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_HIDVOL_HOST_FILL_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
-    LTEXT           "",IDC_BOX_HELP,0,6,226,130
-    PUSHBUTTON      "Open Outer Volume",IDC_OPEN_OUTER_VOLUME,0,136,85,14
+    LTEXT           "",IDC_BOX_HELP,0,6,226,138
+    PUSHBUTTON      "Open Outer Volume",IDC_OPEN_OUTER_VOLUME,0,146,85,14
 END
 
-IDD_HIDDEN_VOL_WIZARD_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_HIDDEN_VOL_WIZARD_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -218,30 +222,36 @@
     LTEXT           "",IDC_BOX_HELP2,16,89,205,50
 END
 
-IDD_PASSWORD_ENTRY_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_PASSWORD_ENTRY_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
-    EDITTEXT        IDC_PASSWORD_DIRECT,50,11,149,14,ES_PASSWORD | ES_AUTOHSCROLL
-    CONTROL         "&Display password",IDC_SHOW_PASSWORD_SINGLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,50,27,84,11,WS_EX_TRANSPARENT
-    CONTROL         "U&se keyfiles",IDC_KEYFILES_ENABLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,50,38,82,11
-    PUSHBUTTON      "&Keyfiles...",IDC_KEY_FILES,135,29,64,14
-    LTEXT           "",IDC_BOX_HELP,0,57,225,94
-    RTEXT           "Password:",IDT_PASSWORD,0,15,48,8
+    EDITTEXT        IDC_PASSWORD_DIRECT,50,2,149,14,ES_PASSWORD | ES_AUTOHSCROLL
+    COMBOBOX        IDC_PKCS5_PRF_ID,50,17,91,90,CBS_DROPDOWNLIST | WS_TABSTOP
+    EDITTEXT        IDC_PIM,50,32,42,14,ES_RIGHT | ES_PASSWORD | ES_AUTOHSCROLL | ES_NUMBER | NOT WS_VISIBLE
+    LTEXT           "(Empty or 0 for default iterations)",IDC_PIM_HELP,96,34,127,8,NOT WS_VISIBLE
+    CONTROL         "&Display password",IDC_SHOW_PASSWORD_SINGLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,50,46,84,11,WS_EX_TRANSPARENT
+    CONTROL         "U&se keyfiles",IDC_KEYFILES_ENABLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,50,57,82,11
+    PUSHBUTTON      "&Keyfiles...",IDC_KEY_FILES,142,54,64,14
+    LTEXT           "",IDC_BOX_HELP,0,74,225,94
+    RTEXT           "Password:",IDT_PASSWORD,0,6,48,8
+    RTEXT           "PKCS-5 PRF:",IDT_PKCS5_PRF,0,19,48,8
+    RTEXT           "Volume PIM:",IDT_PIM,0,35,48,8,NOT WS_VISIBLE
+    CONTROL         "Use P&IM",IDC_PIM_ENABLE,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,50,35,97,10
 END
 
-IDD_VOLUME_TYPE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_VOLUME_TYPE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
-    CONTROL         "Standard TrueCrypt volume",IDC_STD_VOL,"Button",BS_AUTORADIOBUTTON,0,7,212,10
-    CONTROL         "Hi&dden TrueCrypt volume ",IDC_HIDDEN_VOL,"Button",BS_AUTORADIOBUTTON,0,53,212,10
-    LTEXT           "More information about hidden volumes",IDC_HIDDEN_VOL_HELP,16,125,205,10,SS_NOTIFY
+    CONTROL         "Standard VeraCrypt volume",IDC_STD_VOL,"Button",BS_AUTORADIOBUTTON,0,7,212,10
+    CONTROL         "Hi&dden VeraCrypt volume ",IDC_HIDDEN_VOL,"Button",BS_AUTORADIOBUTTON,0,53,212,10
+    LTEXT           "More information about hidden volumes",IDC_HIDDEN_VOL_HELP,16,126,205,10,SS_NOTIFY
     LTEXT           "",IDC_BOX_HELP_NORMAL_VOL,16,20,205,25
     LTEXT           "",IDC_BOX_HELP,16,66,205,57
 END
 
-IDD_SYSENC_SPAN_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_SPAN_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -249,19 +259,19 @@
                     "Button",BS_AUTORADIOBUTTON,0,7,212,10
     CONTROL         "Encrypt the whole drive",IDC_WHOLE_SYS_DRIVE,"Button",BS_AUTORADIOBUTTON,0,53,212,10
     LTEXT           "Select this option to encrypt the partition where the currently running Windows operating system is installed.",IDT_SYS_PARTITION,16,20,205,32
-    LTEXT           "",IDT_WHOLE_SYS_DRIVE,16,66,205,79
+    LTEXT           "",IDT_WHOLE_SYS_DRIVE,16,70,205,95
 END
 
-IDD_SYSENC_RESCUE_DISK_CREATION_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_RESCUE_DISK_CREATION_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
-    EDITTEXT        IDC_RESCUE_DISK_ISO_PATH,0,135,163,13,ES_AUTOHSCROLL
-    PUSHBUTTON      "Bro&wse...",IDC_BROWSE,166,134,59,14
-    LTEXT           "",IDT_RESCUE_DISK_INFO,0,1,225,129
+    EDITTEXT        IDC_RESCUE_DISK_ISO_PATH,0,152,163,13,ES_AUTOHSCROLL
+    PUSHBUTTON      "Bro&wse...",IDC_BROWSE,166,151,59,14
+    LTEXT           "",IDT_RESCUE_DISK_INFO,0,1,225,145
 END
 
-IDD_SYSENC_COLLECTING_RANDOM_DATA_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_COLLECTING_RANDOM_DATA_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -269,9 +279,11 @@
     CONTROL         "",IDC_SYS_POOL_CONTENTS,"Static",SS_LEFTNOWORDWRAP | WS_GROUP,8,14,205,72,WS_EX_TRANSPARENT
     LTEXT           "IMPORTANT: Move your mouse as randomly as possible within this window. The longer you move it, the better. This significantly increases the cryptographic strength of the encryption keys. Then click Next to continue.",IDT_COLLECTING_RANDOM_DATA_NOTE,1,112,224,40
     GROUPBOX        "Current pool content (partial)",IDT_PARTIAL_POOL_CONTENTS,0,5,222,88
+    GROUPBOX        "Randomness Collected From Mouse Movements",IDT_ENTROPY_BAR,0,154,224,18
+    CONTROL         "",IDC_ENTROPY_BAR,"msctls_progress32",WS_BORDER,11,163,202,6
 END
 
-IDD_SYSENC_MULTI_BOOT_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_MULTI_BOOT_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -281,7 +293,7 @@
     LTEXT           "Select this option if there are two or more operating systems installed on this computer.\n\nFor example:\n- Windows XP and Windows XP\n- Windows XP and Windows Vista\n- Windows and Mac OS X\n- Windows and Linux\n- Windows, Linux and Mac OS X",IDT_MULTI_BOOT,16,66,205,72
 END
 
-IDD_SYSENC_RESCUE_DISK_BURN_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_RESCUE_DISK_BURN_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -289,7 +301,7 @@
     LTEXT           "",IDT_RESCUE_DISK_BURN_INFO,0,4,225,128
 END
 
-IDD_SYSENC_WIPE_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_WIPE_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -298,7 +310,7 @@
     LTEXT           "",IDT_WIPE_MODE_INFO,0,19,225,128
 END
 
-IDD_INPLACE_ENCRYPTION_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_INPLACE_ENCRYPTION_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -318,7 +330,7 @@
     GROUPBOX        "",IDC_STATIC,0,32,225,41
 END
 
-IDD_SYSENC_KEYS_GEN_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_KEYS_GEN_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -332,7 +344,7 @@
     GROUPBOX        "",-1,0,65,225,26
 END
 
-IDD_UNIVERSAL_DUAL_CHOICE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_UNIVERSAL_DUAL_CHOICE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -341,7 +353,7 @@
     LTEXT           "",IDC_BOX_HELP,1,34,220,112
 END
 
-IDD_SYSENC_DRIVE_ANALYSIS_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_DRIVE_ANALYSIS_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -350,18 +362,18 @@
     LTEXT           "Progress:",IDT_PROGRESS,2,104,57,8
 END
 
-IDD_SYSENC_TYPE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_TYPE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
     CONTROL         "Normal",IDC_SYSENC_NORMAL,"Button",BS_AUTORADIOBUTTON,0,7,212,10
     CONTROL         "Hi&dden",IDC_SYSENC_HIDDEN,"Button",BS_AUTORADIOBUTTON,0,53,212,10
-    LTEXT           "More information",IDC_HIDDEN_SYSENC_INFO_LINK,16,138,205,10,SS_NOTIFY
+    LTEXT           "More information",IDC_HIDDEN_SYSENC_INFO_LINK,16,148,205,10,SS_NOTIFY
     LTEXT           "",IDC_BOX_HELP_SYSENC_NORMAL,16,20,205,25
-    LTEXT           "",IDC_BOX_HELP,16,66,205,72
+    LTEXT           "",IDC_BOX_HELP,16,67,205,72
 END
 
-IDD_SYSENC_HIDDEN_OS_REQ_CHECK_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_SYSENC_HIDDEN_OS_REQ_CHECK_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -369,7 +381,7 @@
     LTEXT           "",IDC_BOX_HELP,0,2,225,136
 END
 
-IDD_DEVICE_WIPE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_DEVICE_WIPE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 0, 0, 0x0
 BEGIN
@@ -388,7 +400,7 @@
     LTEXT           "",IDC_WIPE_MODE,67,21,125,11,SS_CENTERIMAGE,WS_EX_TRANSPARENT | WS_EX_STATICEDGE
 END
 
-IDD_DEVICE_WIPE_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_DEVICE_WIPE_MODE_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -397,7 +409,7 @@
     LTEXT           "",IDT_WIPE_MODE_INFO,0,29,225,122
 END
 
-IDD_DEVICE_TRANSFORM_MODE_DLG DIALOGEX 0, 0, 226, 152
+IDD_DEVICE_TRANSFORM_MODE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -406,10 +418,10 @@
     CONTROL         "Encrypt partition in place",IDC_DEVICE_TRANSFORM_MODE_INPLACE,
                     "Button",BS_AUTORADIOBUTTON,0,98,217,10
     LTEXT           "",IDC_BOX_HELP,16,21,205,74
-    LTEXT           "",IDC_BOX_HELP2,16,111,205,34
+    LTEXT           "",IDC_BOX_HELP2,16,112,205,53
 END
 
-IDD_EXPANDED_LIST_SELECT_PAGE_DLG DIALOGEX 0, 0, 226, 152
+IDD_EXPANDED_LIST_SELECT_PAGE_DLG DIALOGEX 0, 0, 226, 172
 STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
 FONT 8, "MS Shell Dlg", 400, 0, 0x1
 BEGIN
@@ -417,6 +429,27 @@
     LISTBOX         IDC_LIST_BOX,0,3,222,100,LBS_NOINTEGRALHEIGHT | LBS_DISABLENOSCROLL | WS_VSCROLL
 END
 
+IDD_DRIVE_LETTER_SELECTION_PAGE DIALOGEX 0, 0, 226, 172
+STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
+FONT 8, "MS Shell Dlg", 400, 0, 0x1
+BEGIN
+    LTEXT           "",IDC_BOX_HELP,0,40,225,95
+    COMBOBOX        IDC_DRIVE_LETTER_LIST,94,15,38,69,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP
+    RTEXT           "Drive letter:",IDT_DRIVE_LETTER,5,17,86,8
+END
+
+IDD_PIM_PAGE_DLG DIALOGEX 0, 0, 226, 172
+STYLE DS_SETFONT | DS_FIXEDSYS | DS_CONTROL | WS_CHILD
+FONT 8, "MS Shell Dlg", 0, 0, 0x0
+BEGIN
+    EDITTEXT        IDC_PIM,53,0,42,14,ES_RIGHT | ES_PASSWORD | ES_AUTOHSCROLL | ES_NUMBER
+    LTEXT           "",IDC_BOX_HELP,0,32,225,126
+    RTEXT           "Volume PIM:",IDT_PIM,1,3,50,8
+    LTEXT           "(Empty or 0 for default iterations)",IDC_PIM_HELP,97,3,126,8
+    LTEXT           "Information on PIM",IDC_LINK_PIM_INFO,0,161,213,8,SS_NOTIFY
+    CONTROL         "Display PIM",IDC_SHOW_PIM,"Button",BS_AUTOCHECKBOX | WS_TABSTOP,53,17,150,10
+END
+
 
 #ifdef APSTUDIO_INVOKED
 /////////////////////////////////////////////////////////////////////////////
@@ -457,38 +490,38 @@
     BEGIN
         RIGHTMARGIN, 393
         TOPMARGIN, 1
-        BOTTOMMARGIN, 207
-        HORZGUIDE, 196
+        BOTTOMMARGIN, 227
+        HORZGUIDE, 216
     END
 
     IDD_CIPHER_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 141
+        BOTTOMMARGIN, 161
     END
 
     IDD_PASSWORD_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 123
+        BOTTOMMARGIN, 143
     END
 
     IDD_SIZE_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_VOLUME_LOCATION_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 147
+        BOTTOMMARGIN, 167
     END
 
     IDD_FORMAT_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 217
-        BOTTOMMARGIN, 133
+        BOTTOMMARGIN, 153
         HORZGUIDE, 80
         HORZGUIDE, 96
     END
@@ -498,7 +531,7 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_INFO_PAGE_DLG, DIALOG
@@ -506,7 +539,7 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_HIDVOL_HOST_FILL_PAGE_DLG, DIALOG
@@ -514,7 +547,7 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_HIDDEN_VOL_WIZARD_MODE_PAGE_DLG, DIALOG
@@ -522,13 +555,13 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_PASSWORD_ENTRY_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 123
+        BOTTOMMARGIN, 143
     END
 
     IDD_VOLUME_TYPE_PAGE_DLG, DIALOG
@@ -536,7 +569,7 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_SYSENC_SPAN_PAGE_DLG, DIALOG
@@ -544,19 +577,19 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_SYSENC_RESCUE_DISK_CREATION_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 147
+        BOTTOMMARGIN, 167
     END
 
     IDD_SYSENC_COLLECTING_RANDOM_DATA_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 217
-        BOTTOMMARGIN, 133
+        BOTTOMMARGIN, 153
         HORZGUIDE, 80
         HORZGUIDE, 96
     END
@@ -566,13 +599,13 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_SYSENC_RESCUE_DISK_BURN_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 147
+        BOTTOMMARGIN, 167
     END
 
     IDD_SYSENC_WIPE_MODE_PAGE_DLG, DIALOG
@@ -580,13 +613,13 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_INPLACE_ENCRYPTION_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 217
-        BOTTOMMARGIN, 133
+        BOTTOMMARGIN, 153
         HORZGUIDE, 80
         HORZGUIDE, 96
     END
@@ -594,7 +627,7 @@
     IDD_SYSENC_KEYS_GEN_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 217
-        BOTTOMMARGIN, 133
+        BOTTOMMARGIN, 153
         HORZGUIDE, 80
         HORZGUIDE, 96
     END
@@ -604,13 +637,13 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_SYSENC_DRIVE_ANALYSIS_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 217
-        BOTTOMMARGIN, 133
+        BOTTOMMARGIN, 153
         HORZGUIDE, 80
         HORZGUIDE, 96
     END
@@ -620,19 +653,19 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_SYSENC_HIDDEN_OS_REQ_CHECK_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 223
-        BOTTOMMARGIN, 147
+        BOTTOMMARGIN, 167
     END
 
     IDD_DEVICE_WIPE_PAGE_DLG, DIALOG
     BEGIN
         RIGHTMARGIN, 217
-        BOTTOMMARGIN, 133
+        BOTTOMMARGIN, 153
         HORZGUIDE, 80
         HORZGUIDE, 96
     END
@@ -642,7 +675,7 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_DEVICE_TRANSFORM_MODE_DLG, DIALOG
@@ -650,7 +683,7 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
     END
 
     IDD_EXPANDED_LIST_SELECT_PAGE_DLG, DIALOG
@@ -658,7 +691,21 @@
         LEFTMARGIN, 7
         RIGHTMARGIN, 219
         TOPMARGIN, 7
-        BOTTOMMARGIN, 145
+        BOTTOMMARGIN, 165
+    END
+
+    IDD_DRIVE_LETTER_SELECTION_PAGE, DIALOG
+    BEGIN
+        LEFTMARGIN, 7
+        RIGHTMARGIN, 219
+        TOPMARGIN, 7
+        BOTTOMMARGIN, 165
+    END
+
+    IDD_PIM_PAGE_DLG, DIALOG
+    BEGIN
+        RIGHTMARGIN, 223
+        BOTTOMMARGIN, 171
     END
 END
 #endif    // APSTUDIO_INVOKED
@@ -669,7 +716,7 @@
 // Bitmap
 //
 
-IDB_WIZARD              BITMAP                  "TrueCrypt_wizard.bmp"
+IDB_WIZARD              BITMAP                  "VeraCrypt_wizard.bmp"
 
 /////////////////////////////////////////////////////////////////////////////
 //
@@ -678,7 +725,7 @@
 
 STRINGTABLE 
 BEGIN
-    IDS_UACSTRING_FMT       "TrueCrypt"
+    IDS_UACSTRING_FMT       "VeraCrypt"
 END
 
 #endif    // English (U.S.) resources
